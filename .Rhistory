knitr::opts_chunk$set(echo = TRUE)
#import data
data2<-read.csv("heart.csv",stringsAsFactors = F,header = T)
#import data
data2<-read.csv("heart.csv",stringsAsFactors = F,header = T)
data2
#Lets check structure of data
str(data2)
#Lets check structure of data
str(data2)
dim(data2)
load("D:/codebase/rda/21661-0002-Data (1).rda")
read.csv("D:/codebase/rda/21661-0002-Data (1).rda")
load("D:/codebase/rda/21661-0002-Data (1).rda")
View(da21661.0002)
View(da21661.0002)
View(da21661.0002)
View(da21661.0002)
View(data2)
View(da21661.0002)
View(da21661.0002)
View(da21661.0002)
str(da21661.0002)
na.omit(da21661.0002)
str(da21661.0002)
knitr::opts_chunk$set(echo = TRUE)
data3<-da21661.0002
data3<-da21661.0002
data3<-na.omit(data3)
data3<-da21661.0002
data3<-na.omit(data3)
str(data3)
data3<-da21661.0002
str(data3)
data3<-da21661.0002
str(data3)
data3%>%
replace_na(0)
data3<-da21661.0002
str(data3)
colSums(is.na(data3))
colSums(is.na(data3))
colSums(is.na(data3))
data3(select(data3,-c(IDPUNCH,ITEXCLUD,ILTEACH4 ,ILLINK4, ILTEACH5, ILLINK5,ITLANG  BSGBRN2 ,BS401,
#colSums(is.na(data3))
data3<-(select(data3,-c(IDPUNCH,ITEXCLUD,ILTEACH4 ,ILLINK4, ILTEACH5, ILLINK5,ITLANG  BSGBRN2 ,BS401,
#colSums(is.na(data3))
data3<-(select(data3,-c(IDPUNCH,ITEXCLUD,ILTEACH4 ,ILLINK4, ILTEACH5, ILLINK5,ITLANG  BSGBRN2 ,BS401,
#colSums(is.na(data3))
cori<-c("IDPUNCH","ITEXCLUD","ILTEACH4" ,"ILLINK4", "ILTEACH5", "ILLINK5","ITLANG " "BSGBRN2" ,"BS401", "BS4O2"  , " BS4O3"  ,  "BS4O4"  , " BS4O5"  ,  "BSGP1 " ,  "BSRR1" ,  "BSRR2A " , "BSRR2B" ,"BSRR2C"  , "BSRR2D"  , "BSRR2E" ,  "BSRR2F " , "BSRR2G "  ,"BSRR2H"  ," BSRR2I" , " BSRR2J"," BSRR2K " , "BS1EU1" ,  "BS1EU2" ,  "BS1EU3"  , "ITPART" ," WGTFAC1",  "WGTADJ1"  ,"WGTFAC2" )
#colSums(is.na(data3))
cori<-c("IDPUNCH","ITEXCLUD","ILTEACH4" ,"ILLINK4", "ILTEACH5", "ILLINK5","ITLANG " "BSGBRN2" ,"BS401", "BS4O2"  , " BS4O3"  ,  "BS4O4", " BS4O5"  ,  "BSGP1 " ,  "BSRR1" ,  "BSRR2A " , "BSRR2B" ,"BSRR2C"  , "BSRR2D"  , "BSRR2E" ,  "BSRR2F " , "BSRR2G "  ,"BSRR2H"  ," BSRR2I" , " BSRR2J"," BSRR2K " , "BS1EU1" ,  "BS1EU2" ,  "BS1EU3"  , "ITPART" ," WGTFAC1",  "WGTADJ1"  ,"WGTFAC2" )
#colSums(is.na(data3))
cori<-c("IDPUNCH","ITEXCLUD","ILTEACH4" ,"ILLINK4", "ILTEACH5", "ILLINK5","ITLANG " "BSGBRN2" ,"BS401", "BS4O2"  , " BS4O3"  ,  "BS4O4", " BS4O5"  ,  "BSGP1 " ,  "BSRR1" ,  "BSRR2A " , "BSRR2B" ,"BSRR2C"  , "BSRR2D"  , "BSRR2E" ,  "BSRR2F " , "BSRR2G "  ,"BSRR2H"  ," BSRR2I" , " BSRR2J"," BSRR2K " , "BS1EU1" ,  "BS1EU2" ,  "BS1EU3"  , "ITPART" ," WGTFAC1",  "WGTADJ1"  ,"WGTFAC2" )
data4<-da21661.0002
#Lets check structure of data
str(data2)
dim(data2)
colnames(data2) = c("age","sex","chest_pain_type","rest_bp","ser_cholestral","fast_blo_sugar","ret_elect","heart_rate","ex_ind","st_depr","slope_ex","maj_vess","defect","target")
#Lets check structure of data
str(data2)
dim(data2)
colnames(data2) = c("age","sex","chest_pain_type","rest_bp","ser_cholestral","fast_blo_sugar","ret_elect","heart_rate","ex_ind","st_depr","slope_ex","maj_vess","defect","target")
colnames(data2)
#Lets check structure of data
str(data2)
dim(data2)
colnames(data2) = c("age","sex","chest_pain_type","rest_bp","ser_cholestral","fast_blo_sugar","ret_elect","heart_rate","ex_ind","st_depr","slope_ex","maj_vess","defect","target")
colnames(data2)
colSums(is.na(data2))
library(ranger)
model<-ranger(fast_blo_sugar~.,data = data2[1:200,])
library(ranger)
model<-ranger(fast_blo_sugar~.,data = data2[1:200,])
t<-predict(model,data2[201:303,])
library(ranger)
model<-ranger(fast_blo_sugar~.,data = data2[1:200,])
t<-predict(model,data2[201:303,])
mean(t$predictions==data[201:303,6])
library(ranger)
model<-ranger(fast_blo_sugar~.,data = data2[1:200,])
t<-predict(model,data2[201:303,])
test<-data2[201:303,]
mean(t$predictions==test$)
library(ranger)
model<-ranger(fast_blo_sugar~.,data = data2[1:200,])
t<-predict(model,data2[201:303,])
test<-data2[201:303,]
mean(t$predictions==test$fast_blo_sugar)
library(ranger)
model<-ranger(fast_blo_sugar~.,data = data2[1:200,])
t<-predict(model,data2[201:303,])
test<-data2[201:303,]
mean(t==test$fast_blo_sugar)
library(ranger)
model<-ranger(fast_blo_sugar~.,data = data2[1:200,])
t<-predict(model,data2[201:303,])
test<-data2[201:303,]
table(t$predictions,test$fast_blo_sugar)
data2$fast_blo_sugar<-as.factor(data2$fast_blo_sugar)
library(ranger)
model<-ranger(fast_blo_sugar~.,data = data2[1:200,])
t<-predict(model,data2[201:303,])
test<-data2[201:303,]
table(t$predictions,test$fast_blo_sugar)
data2$fast_blo_sugar<-as.factor(data2$fast_blo_sugar)
library(ranger)
model<-ranger(fast_blo_sugar~.,data = data2[1:200,])
t<-predict(model,data2[201:303,])
test<-data2[201:303,]
table(t$predictions,test$fast_blo_sugar)
mean(t$predictions==test$fast_blo_sugar)
#Lets check structure of data
str(data2)
dim(data2)
colnames(data2) = c("age","sex","chest_pain_type","rest_bp","ser_cholestral","fast_blo_sugar","ret_elect","heart_rate","ex_ind","st_depr","slope_ex","maj_vess","defect","target")
colnames(data2)
colSums(is.na(data2))
?ranger
data2$fast_blo_sugar<-as.factor(data2$fast_blo_sugar)
library(ranger)
model<-ranger(fast_blo_sugar~.,data = data2[1:200,],num.trees = 1000,respect.unordered.factors = "ordered")
data2$fast_blo_sugar<-as.factor(data2$fast_blo_sugar)
library(ranger)
model<-ranger(fast_blo_sugar~.,data = data2[1:200,],num.trees = 1000,respect.unordered.factors = "order")
t<-predict(model,data2[201:303,])
test<-data2[201:303,]
table(t$predictions,test$fast_blo_sugar)
mean(t$predictions==test$fast_blo_sugar)
data2$fast_blo_sugar<-as.factor(data2$fast_blo_sugar)
library(ranger)
model<-ranger(fast_blo_sugar~.,data = data2[1:200,],num.trees = 1000,respect.unordered.factors = "order")
t<-predict(model,data2[201:303,])
test<-data2[201:303,]
table(t$predictions,test$fast_blo_sugar)
mean(t$predictions==test$fast_blo_sugar)
knitr::opts_chunk$set(echo = TRUE)
data2$fast_blo_sugar<-as.factor(data2$fast_blo_sugar)
library(ranger)
model<-ranger(fast_blo_sugar~.,data = data2[1:200,],num.trees = 1000,respect.unordered.factors = "order")
t<-predict(model,data2[201:303,])
test<-data2[201:303,]
table(t$predictions,test$fast_blo_sugar)
mean(t$predictions==test$fast_blo_sugar)
data2$fast_blo_sugar<-as.factor(data2$fast_blo_sugar)
library(ranger)
model<-ranger(fast_blo_sugar~.,data = data2[1:200,],num.trees = 1000,respect.unordered.factors = "order")
t<-predict(model,data2[201:303,])
test<-data2[201:303,]
table(t$predictions,test$fast_blo_sugar)
mean(t$predictions==test$fast_blo_sugar)
?glm
train<-data2[1:200,]
lmodel<-glm(fast_blo_sugar~.,train,method = "binomial")
train<-data2[1:200,]
lmodel<-glm(fast_blo_sugar~.,train,family =  "binomial")
train<-data2[1:200,]
lmodel<-glm(fast_blo_sugar~.,train,family =  "binomial")
predl<-predict(lmodel,test)
predl_p<-ifelse(predl>0.5,1,0)
table
train<-data2[1:200,]
lmodel<-glm(fast_blo_sugar~.,train,family =  "binomial")
predl<-predict(lmodel,test)
predl_p<-ifelse(predl>0.5,1,0)
table(predl_p,test$fast_blo_sugar)
train<-data2[1:200,]
lmodel<-glm(fast_blo_sugar~.,train,family =  "binomial")
predl<-predict(lmodel,test)
predl_p<-ifelse(predl>0.5,1,0)
table(predl_p,test$fast_blo_sugar)
mean(predl_p==test$fast_blo_sugar)
summary(data2)
#Lets check structure of data
str(data2)
dim(data2)
colnames(data2) = c("age","sex","chest_pain_type","rest_bp","ser_cholestral","fast_blo_sugar","ret_elect","heart_rate","ex_ind","st_depr","slope_ex","maj_vess","defect","target")
colnames(data2)
colSums(is.na(data2))
cols<-c("target","sex","chest_pain_type","ret_elect","ex_ind","maj_vess","defect")
for (i in cols) {
data2[,i]=as.factor(data2[,i])
}
str(data2)
data2$fast_blo_sugar<-as.factor(data2$fast_blo_sugar)
library(ranger)
model<-ranger(fast_blo_sugar~.,data = data2[1:200,],num.trees = 1000,respect.unordered.factors = "order")
t<-predict(model,data2[201:303,])
test<-data2[201:303,]
table(t$predictions,test$fast_blo_sugar)
mean(t$predictions==test$fast_blo_sugar)
?glm
train<-data2[1:200,]
lmodel<-glm(fast_blo_sugar~.,train,family =  "binomial")
predl<-predict(lmodel,test)
predl_p<-ifelse(predl>0.5,1,0)
table(predl_p,test$fast_blo_sugar)
mean(predl_p==test$fast_blo_sugar)
summary(data2)
dtrain <- xgb.DMatrix(as.matrix(train),
label = as.numeric(train$fast_blo_sugar)-1)
library(xgboost)
dtrain <- xgb.DMatrix(as.matrix(train),
label = as.numeric(train$fast_blo_sugar)-1)
data2$fast_blo_sugar<-as.character(data2$fast_blo_sugar)
library(ranger)
model<-ranger(fast_blo_sugar~.,data = data2[1:200,],num.trees = 1000,respect.unordered.factors = "order")
t<-predict(model,data2[201:303,])
test<-data2[201:303,]
table(t$predictions,test$fast_blo_sugar)
mean(t$predictions==test$fast_blo_sugar)
?glm
library(xgboost)
dtrain <- xgb.DMatrix(as.matrix(train),
label = as.numeric(train$fast_blo_sugar)-1)
knitr::opts_chunk$set(echo = TRUE)
#import data
data2<-read.csv("heart.csv",stringsAsFactors = F,header = T)
data2
str(data2)
train_data<-data2[1:200,]
test_data<-data2[201:303,]
library(xgboost)
dtrain <- xgb.DMatrix(as.matrix(train_data),
label = as.numeric(train$fast_blo_sugar))
dtest <- xgb.DMatrix(as.matrix(test_data),
label = as.numeric(test$fast_blo_sugar))
params <- list(max_depth = 3,
objective = "binary:logistic",
silent = 0)
watchlist <- list(train = dtrain, eval = dtest)
bst_model <- xgb.train(params = params,
data = dtrain,
nrounds = 10,
watchlist = watchlist,
verbose = FALSE,
prediction = TRUE)
train_data<-data2[1:200,]
test_data<-data2[201:303,]
str(data2)
library(xgboost)
dtrain <- xgb.DMatrix(as.matrix(train_data),
label = as.numeric(train$fast_blo_sugar))
dtest <- xgb.DMatrix(as.matrix(test_data),
label = as.numeric(test$fast_blo_sugar))
